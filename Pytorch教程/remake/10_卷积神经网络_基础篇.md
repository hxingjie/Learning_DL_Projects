```python
import torch
in_channels, out_channels = 5, 10
width, height = 100, 100
kernel_size = 3
batch_size = 1

input_val = torch.randn(batch_size, in_channels, width, height)

conv_layer = torch.nn.Conv2d(in_channels, out_channels, kernel_size=(batch_size, batch_size))
# padding = kernel_size / 2
# bias: 是否加偏置量

output_val = conv_layer(input_val)

print(input_val.shape)  # batch_size, in_channels, width, height
print(conv_layer.weight.shape)  # out_channels, in_channels, kernel_size_width, kernel_size_height
print(output_val.shape)  # batch_size, out_channels, width`, height`
```
---
## 卷积
```python
import torch

input_val = [3, 4, 6, 5, 7,
             2, 4, 6, 8, 2,
             1, 6, 7, 8, 4,
             9, 7, 4, 6, 2,
             3, 7, 5, 4, 1]
input_val = torch.tensor(input_val, dtype=torch.float32).reshape(1, 1, 5, 5)

conv_layer = torch.nn.Conv2d(1, 1, kernel_size=3, padding=1, stride=2, bias=False)  # in, out, kernel_size, padding, bias
kernel = torch.tensor([1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=torch.float32).reshape(1, 1, 3, 3)  # out, in, w, h
# kernel_size: 3 * 3, output_val小1圈 3/2
# kernel_size: 5 * 5, output_val小2圈 5/2
conv_layer.weight.data = kernel.data

output_val = conv_layer(input_val)

print(output_val)
```
---
## 下采样
```python
import torch
# 最大池化层
input_val = [3, 4, 6, 5,
             2, 4, 6, 8,
             1, 6, 7, 8,
             9, 7, 4, 6]
input_val = torch.tensor(input_val, dtype=torch.float32).reshape(1, 1, 4, 4)

maxpooling_layer = torch.nn.MaxPool2d(kernel_size=2, stride=2)

output_val = maxpooling_layer(input_val)

print(output_val)
```
